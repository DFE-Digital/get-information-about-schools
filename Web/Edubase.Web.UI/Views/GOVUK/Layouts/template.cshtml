@using Edubase.Web.UI.Controllers
@using Microsoft.AspNet.Identity
@{
    ViewBag.assetsPath = "/public/govuk_template/assets";

    var title = !string.IsNullOrEmpty(ViewBag.Title) ? ViewBag.Title : "Get information about schools";
    var documentTitle = string.Format("{0} - {1}", title, "GOV.UK");
    var gtmKey = System.Configuration.ConfigurationManager.AppSettings["GoogleTagManagerKey"];

    var envHeader = System.Configuration.ConfigurationManager.AppSettings["Environment"] ?? string.Empty;
    var version = typeof(HomeController).Assembly.GetName().Version;
}
<!DOCTYPE html>
<!--[if lt IE 9]><html class="lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!-->
<html lang="en">
<!--<![endif]-->
<head>
    <!-- Google Tag Manager -->
    <script nonce="@Html.ScriptNonce()">
        (function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', '@gtmKey'); //
    </script>
    <!-- End Google Tag Manager -->

    <title>@documentTitle</title>
    <meta name="google-site-verification" content="uRt7CAkfClOB8Jig6Pw2-DELUWuuyG2kYKip0UThxhg" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:image" content="@(ViewBag.assetsPath)/images/opengraph-image.png?0.12.0">
    <meta name="description" content="@(ViewBag.pageDescription)">
    <meta name="keywords" content="Edubase" />

    <script type="text/javascript" nonce="@Html.ScriptNonce()">
        (function () {
            if (navigator.userAgent.match(/IEMobile\/10\.0/)) {
                var d = document, c = "appendChild", a = d.createElement("style");
                a[c](d.createTextNode("@@-ms-viewport{width:auto!important}"));
                d.getElementsByTagName("head")[0][c](a);
            }
        })();
    </script>

    <!--[if gt IE 8]><!-->
    <link href="@(ViewBag.assetsPath)/stylesheets/govuk-template.css?0.12.0" media="screen" rel="stylesheet" type="text/css" /><!--<![endif]-->
    <!--[if IE 6]><link href="@(ViewBag.assetsPath)/stylesheets/govuk-template-ie6.css?0.12.0" media="screen" rel="stylesheet" type="text/css"/><![endif]-->
    <!--[if IE 7]<link href="@(ViewBag.assetsPath)/stylesheets/govuk-template-ie7.css?0.12.0" media="screen" rel="stylesheet" type="text/css"/><![endif]-->
    <!--[if IE 8]><link href="@(ViewBag.assetsPath)/stylesheets/govuk-template-ie8.css?0.12.0" media="screen" rel="stylesheet" type="text/css"/><![endif]-->

    <link href="@(ViewBag.assetsPath)/stylesheets/govuk-template-print.css?0.12.0" media="print" rel="stylesheet" type="text/css" />

    <!--[if IE 8]>
    <script type="text/javascript" nonce="@Html.ScriptNonce()">
        (function () {
            if (window.opera) {
                return;
            }
            setTimeout(function() {
                var a = document,
                    g,
                    b = {
                        families: (g =["nta"]),urls: ["@(ViewBag.assetsPath)/stylesheets/fonts-ie8.css?0.12.0"]
                    },
                    c = "@(ViewBag.assetsPath)/javascripts/vendor/goog/webfont-debug.js?0.12.0",
                    d = "script",
                    e = a.createElement(d),
                    f = a.getElementsByTagName(d)[0],
                    h = g.length;
                WebFontConfig = { custom: b }, e.src = c, f.parentNode.insertBefore(e, f);
                for (; h = h - 1; a.documentElement.className += ' wf-' + g[h].replace(/\s/g, '').toLowerCase() + '-n4-loading');
            }, 0);
        })()
    </script>
    <![endif]-->
    <!--[if gte IE 9]><!-->
    <link href="@(ViewBag.assetsPath)/stylesheets/fonts.css?0.12.0" media="all" rel="stylesheet" type="text/css" />
    <!--<![endif]-->
    <!--[if lt IE 9]>
    <script src="@(ViewBag.assetsPath)/javascripts/ie.js?0.12.0" type="text/javascript"></script>
    <![endif]-->

    <link rel="shortcut icon" href="@(ViewBag.assetsPath)/images/favicon.ico?0.12.0" type="image/x-icon" />

    <!-- Size for iPad and iPad mini (high resolution) -->
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="@(ViewBag.assetsPath)/images/apple-touch-icon-152x152.png?0.12.0">
    <!-- Size for iPhone and iPod touch (high resolution) -->
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="@(ViewBag.assetsPath)/images/apple-touch-icon-120x120.png?0.12.0">
    <!-- Size for iPad 2 and iPad mini (standard resolution) -->
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="@(ViewBag.assetsPath)/images/apple-touch-icon-76x76.png?0.12.0">
    <!-- Default non-defined size, also used for Android 2.1+ devices -->
    <link rel="apple-touch-icon-precomposed" href="@(ViewBag.assetsPath)/images/apple-touch-icon-60x60.png?0.12.0">

    @RenderSection("Head", required: false)

</head>
<body class="@(ViewBag.bodyClasses) no-js">
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=@gtmKey" height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->

    <div id="full-content">
        @if (!Request.Browser.Browser.Contains("MSIE 8"))
        {
            <script type="text/javascript" nonce="@Html.ScriptNonce()">
                document.body.className = document.body.className.replace(/\bno-js\b/, 'js-enabled');
                if (!('ontouchstart' in document.documentElement)) { document.body.className += ' no-touch'; }
                if (navigator.userAgent.indexOf('Mac OS X') > -1) { document.body.className += ' is-mac'; }
            </script>
        }

        @RenderSection("bodyStart", required: false)

        <div id="skiplink-container">
            <div>
                <a href="#content" class="skiplink">Skip to main content</a>
            </div>
        </div>

        <div class="app-cookie-banner js-cookie-banner" id="global-cookie-message">
            @if (string.IsNullOrEmpty(ViewBag.cookieMessage) == false)
            {
                @(ViewBag.cookieMessage)
            }
            else
            {
                <p class="govuk-width-container">
                    GOV.UK uses cookies which are essential for the site to work. We also use non-essential cookies to help us improve government digital services. Any data collected is anonymised. By continuing to use this site, you agree to our use of cookies. @Html.ActionLink("Find out more about cookies", "Cookies", "Home", new {area=""}, new { @class="govuk-link" })<br />
                    <button class="govuk-button" id="button-accept-cookies">Accept cookies</button>
                </p>
            }
        </div>

        <!--end global-cookie-message-->

        <header role="banner" id="global-header" class="with-proposition">

            @{
                switch (envHeader.ToLower())
                {
                    case "localdev":
                        <div style='background-color: #68dcde; text-align: center'><span class="bold-xsmall">ATTENTION!</span> This is a <span class="bold-xsmall">Test</span> version, running locally</div>
                        break;

                    case "dev":
                    case "exp":
                        <div style='background-color: #59f051; text-align: center'><span class="bold-xsmall">ATTENTION!</span> This is a <span class="bold-xsmall">Test</span> version shared with other developers</div>
                        break;

                    case "stage":
                        <div style='background-color: #FFA500; text-align: center'><span class="bold-xsmall">ATTENTION!</span> This is a <span class="bold-xsmall">Pre-production</span> version used for testing purposes</div>
                        break;

                    case "prodlcs":
                        <div style='background-color: #FF0000; text-align: center'><span class="bold-xsmall">ATTENTION!</span> This is a <span class="bold-xsmall">Prod LCS</span> version</div>
                            break;
                    }
                }

            <div class="header-wrapper">
                <div class="header-global">
                    <div class="header-logo">
                        <a href="http://www.gov.uk/" title="Go to the GOV.UK homepage" id="logo" class="content">
                            <img src="/public/govuk_template/assets/images/gov.uk_logotype_crown.png?0.13.0" width="35" height="31" alt="" style="visibility: visible">
                            GOV.UK
                        </a>
                    </div>
                    @RenderSection("InsideHeader", required: false)
                </div>
                <div class="header-proposition">
                    <div class="content">
                        <a href="#proposition-links" class="js-header-toggle menu">Menu</a>
                        <nav id="proposition-menu">
                            @Html.ActionLink("Get information about schools", "Index", "Search", new {area = ""}, new { id="proposition-name"})

                            <ul id="proposition-links">
                                <li>@Html.ActionLink("Search", "Index", "Search", new {area = ""}, null)</li>
                                <li>@Html.ActionLink("Downloads", "Index", "Downloads", new {area = ""}, null)</li>

                                @if (Request.IsAuthenticated)
                                {
                                    <li>@Html.ActionLink("Tools", "Index", "Tools", new {area = ""}, null)</li>
                                }

                                <li>@Html.ActionLink("Help", "Help", "Home", new {area = ""}, null)</li>
                                <li>@Html.ActionLink("News", "News", "Home", new {area = ""}, null)</li>

                                @if (Request.IsAuthenticated)
                                {
                                    <li>@Html.ActionLink("Sign off", "LogOff", "Account", new { area = "", returnUrl = Request.Url.PathAndQuery }, new { id = "logout-link", Class = "login-link", rel = "nofollow" })</li>
                                }
                                else
                                {
                                    <li>@Html.ActionLink("Sign in", "LogIn", "Account", new { area = "", returnUrl = Request.Url.PathAndQuery }, new { Class = "login-link", rel = "nofollow" })</li>
                                }
                                </ul>

                        </nav>
                    </div>
                </div>
            </div>
        </header>
        <!--end header-->

        @RenderSection("AfterHeader", required: false)

        <div id="global-header-bar">
            <div class="inner-block">
                <div class="header-bar"></div>
            </div>
        </div>
        <!--end global-header-bar-->

        <div class="side-width-wrapper">
            <div class="grid-row">
                <div class="column-full">
                    <div class="phase-banner">
                        @(Html.Partial("../govuk/partials/phase/beta"))
                    </div>
                    @*@if (User.Identity.IsAuthenticated)
                        {
                            @Html.ActionLink("Sign out", "LogOff", "Account", null, new { @class = "sign-out-link" })
                        }*@
                </div>
            </div>
        </div>

        @if (User.Identity.IsAuthenticated)
        {
            <div class="side-width-wrapper">
                <div class="grid-row">
                    <div class="column-full">

                    </div>
                </div>
            </div>
        }

        @RenderBody()

        <footer class="group js-footer" id="footer" role="contentinfo">
            <div class="footer-wrapper">
                <div class="footer-meta">
                    <div class="footer-meta-inner">
                        <h2 class="visuallyhidden">Support links</h2>
                        <ul>
                            <li><a href="https://form.education.gov.uk/fillform.php?self=1&form_id=hGz7nZcsdnX&noLoginPrompt=1" target="_blank" rel="external">Contact <span class="visually-hidden">Opens in new window</span></a></li>
                            <li>@Html.ActionLink("Cookies", "Cookies", "Home")</li>
                            <li>@Html.RouteLink("Glossary", "Glossary")</li>
                            <li>@Html.ActionLink("Guidance", "Guidance", "Home")</li>
                            @*<li>@Html.ActionLink("News", "News", "Home")</li>*@
                        </ul>

                        <div class="open-government-licence">
                            <p class="logo"><a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="license">Open Government Licence</a></p>
                            <p>All content is available under the <a href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/" rel="license">Open Government Licence v3.0</a>, except where otherwise stated</p>
                            <p>v @version</p>
                        </div>
                    </div>
                    <div class="copyright">
                        <a href="https://www.nationalarchives.gov.uk/information-management/our-services/crown-copyright.htm">&copy; Crown copyright</a>
                    </div>
                </div>
            </div>
        </footer>
        <!--end footer-->

        <div id="global-app-error" class="app-error hidden"></div>
        <script src="@(ViewBag.assetsPath)/javascripts/govuk-template.js?0.13.0" type="text/javascript"></script>

        @RenderSection("BodyEnd", required: false)

        @if (Request.IsAuthenticated)
        {
            <script type="text/javascript" src="/public/assets/scripts/standalone/data-status.js"></script>
        }

        <script nonce="@Html.ScriptNonce()">
            (function () {
                var myetag = GOVUK.getCookie("@Edubase.Web.UI.Controllers.HomeController.NewsBlobETag");
                var etag = "@Edubase.Web.UI.Controllers.HomeController.GetNewsPageETag()";

                if (!myetag) myetag = null;
                if (!etag) etag = null;

                if (myetag != etag) {
                    console.log("Showing modal");
                    $("<p/>").okCancel({
                        immediate: true,
                        ok: function () {
                            location.href = "/news";
                        },
                        title: 'The News page has been updated',
                        content: 'A new article has been added to the News Page that could help your Get information about schools experience. Click \'Go to news page\' to view the News Page or find the News link in the black header.',
                        triggerEvent: 'click',
                        okLabel: "Go to News page"
                    });
                    GOVUK.setCookie("@Edubase.Web.UI.Controllers.HomeController.NewsBlobETag", etag, { days: 365 });
                    console.log("Saved cookie");
                }
            })();


        </script>

    </div>

    <script nonce="@Html.ScriptNonce()">
        if (top.location !== location) {
            top.location.href = document.location.href;
        }
    </script>

</body>

</html>
