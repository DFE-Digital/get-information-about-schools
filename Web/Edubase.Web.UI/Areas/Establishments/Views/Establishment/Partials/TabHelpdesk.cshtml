@using Edubase.Common
@model EstablishmentDetailViewModel

<div id="helpdesk" class="tab-content">
    @if (Model.UserCanEdit && Model.TabEditPolicy.Helpdesk)
    {
        @Html.ActionLink("Edit helpdesk notes", "EditHelpdesk", "Establishment", new {id = Model.Establishment.Urn}, new {@class = "govuk-button govuk-button--secondary"})
    }

    <div class="detail-summary">

        <h2 class="govuk-heading-s">Helpdesk notes:</h2>
        <div class="govuk-body">@(Model.Establishment.HelpdeskNotes.Clean() ?? "Not recorded")</div>

        <dl class="gias-summary-list">
            @if (Model.DisplayPolicy.HelpdeskLastUpdate)
            {
                <div class="gias-summary-list__row">
                    <dt class="gias-summary-list__key">EduBase last update:</dt>
                    <dd class="gias-summary-list__value">@(Model.Establishment.HelpdeskLastUpdate?.ToString("dd MMMM yyyy"))</dd>
                </div>
            }
            @if (Model.DisplayPolicy.HelpdeskTrigger1)
            {
                <div class="gias-summary-list__row">
                    <dt class="gias-summary-list__key">EduBase trigger 1:</dt>
                    <dd class="gias-summary-list__value">@Model.Establishment.HelpdeskTrigger1</dd>
                </div>
            }
            @if (Model.DisplayPolicy.HelpdeskPreviousLocalAuthorityId)
            {
                <div class="gias-summary-list__row">
                    <dt class="gias-summary-list__key">Previous local authority:</dt>
                    <dd class="gias-summary-list__value">@Model.HelpdeskPreviousLocalAuthorityName</dd>
                </div>
            }
            @if (Model.DisplayPolicy.HelpdeskPreviousEstablishmentNumber)
            {
                <div class="gias-summary-list__row">
                    <dt class="gias-summary-list__key">Previous establishment number:</dt>
                    <dd class="gias-summary-list__value">@Model.Establishment.HelpdeskPreviousEstablishmentNumber</dd>
                </div>
            }

        </dl>
    </div>

    @if (Model.UserCanEdit && Model.TabEditPolicy.Helpdesk)
    {
        <div class="govuk-!-padding-top-4">
            @Html.ActionLink("Edit helpdesk notes", "EditHelpdesk", "Establishment", new {id = Model.Establishment.Urn}, new {@class = "govuk-button govuk-button--secondary"})
        </div>
    }
</div>
