@model ChangeHistoryViewModel
@{
    ViewBag.Title = "Search change history";
    ViewBag.bodyClasses = "search-changes";
}
<div class="breadcrumbs">
    <ul>
        <li>
            @Html.ActionLink("Home", "Index", "Search", new { area = "" }, null)
        </li>
        <li>
            @Html.ActionLink("Tools", "Index", "Tools", new { area = "" }, null)
        </li>        
    </ul>
</div>

<h1 class="heading-xlarge">Change history</h1>

<div class="grid-row" id="change-history-app">
    <div class="column-two-thirds">
        <p>
            This allows you to find out when establishments (such as schools, colleges and
            children's centres) and groups (such as multi academy trusts and federations)
            made changes to their records and what was changed.
        </p>
    </div>
        
    <div class="column-full">
        <div class="horizontal-tabs-wrapper">
            <div class="tab-wrap search-tabs">
                <ul class="horizontal-tabs">
                    <li>
                        @{ var estabSelected = Model.SelectedTab == ChangeHistoryViewModel.Tab.Establishments ? "selected-tab" : ""; }
                        @Html.RouteLink("Find an establishment", "ChangeHistoryCriteria", new {SelectedTab = "Establishments"}, new {@class = $"horizontal-tab estab {estabSelected}" })
                        @*<a href="/?SelectedTab=Establishments" class="horizontal-tab estab @((Model.SelectedTab == ChangeHistoryViewModel.Tab.Establishments) ? "selected-tab" : "")">
                            Find an establishment
                        </a>*@
                    </li>
                    <li>
                        @{ var groupSelected = Model.SelectedTab == ChangeHistoryViewModel.Tab.Groups ? "selected-tab" : ""; }
                        @Html.RouteLink("Find an establishment group", "ChangeHistoryCriteria", new { SelectedTab = "Groups" }, new { @class = $"horizontal-tab group {groupSelected}" })
                        @*<a href="/?SelectedTab=Groups" class="horizontal-tab group @((Model.SelectedTab == ChangeHistoryViewModel.Tab.Groups) ? "selected-tab" : "")">
                            Find an establishment group
                        </a>*@
                    </li>
                </ul>
            </div>

            <div class="tab-content-wrapper horizontal-tabs-content">
                <div id="establishments" class="tab-content @((Model.SelectedTab != ChangeHistoryViewModel.Tab.Establishments) ? "hidden-tab-content" : "")" aria-hidden="@(Model.SelectedTab != ChangeHistoryViewModel.Tab.Establishments)">

                    <fieldset class="search-types-accordion">
                        <legend>Search by:</legend>

                        <ul class="search-type-list has-typeahead">
                            <li class="search-type-wrapper">
                                @using (Html.BeginRouteForm("ChangeHistorySearch", FormMethod.Get))
                                {
                                    @Html.HiddenFor(m => m.SelectedTab)
                                    <fieldset class="search-toggle-panel">
                                        <legend class="visually-hidden">Search by name of reference number</legend>
                                        <span class="radio-button-wrap">                        
                                            @Html.RadioButtonFor(m => m.SearchType, eSearchType.Text, new { id = "searchtype-name", data_toggle_panel = "#searchby-name-ref" })
                                            <label class="edubase-button-radio" for="searchtype-name">
                                                Name or reference number
                                            </label>
                                        </span>
                                        <div class="expanding-search-field" id="searchby-name-ref">
                                            @if (Model.NoResultsForName)
                                            {
                                                <div class="warning-message">
                                                    <p>We couldn't find any establishments matching your search criteria</p>
                                                </div>
                                            }
                                            <span class="search-hint">
                                                Name, URN, LAESTAB or UKPRN
                                                <a href="#name-reference-help" class="icon-help">
                                                    <span class="visuallyhidden">About reference numbers</span>
                                                </a>
                                            </span>
                                            <div class="form-group">
                                                @Html.TextBoxFor(x => x.TextSearchModel.Text, new { @class = "form-control", autocomplete = "off", data_suggestion_url = "/search/suggest?text=" })
                                            </div>
                                            @Html.HiddenFor(x => x.TextSearchModel.AutoSuggestValue)
                                            <div class="form-group">
                                                <button type="submit" class="button mobile-full-width search-button" id="name-search-submit">Search</button>
                                            </div>
                                        </div>
                                    </fieldset>

                                }
                            </li>
                        </ul>
                        <p>or</p>
                        <ul>
                            <li class="search-type-wrapper">
                                @using (Html.BeginRouteForm("ChangeHistorySearch", FormMethod.Get))
                                {
                                    <fieldset class="search-toggle-panel">
                                        <legend class="visually-hidden">Search by name of reference number</legend>
                                        <span class="radio-button-wrap">
                                            @Html.HiddenFor(m => m.SelectedTab)
                                            @Html.RadioButtonFor(m => m.SearchType, eSearchType.EstablishmentAll, new { id = "searchtype-all", data_toggle_panel = "#searchby-all-ref" })
                                            <label class="edubase-button-radio" for="searchtype-all">
                                                All establishments
                                            </label>
                                        </span>
                                        <div class="expanding-search-field" id="searchby-all-ref">
                                            @if (Model.NoResultsForName)
                                            {
                                                <div class="warning-message">
                                                    <p>We couldn't find any establishments matching your search criteria</p>
                                                </div>
                                            }
                                            <div class="column-third">
                                                <span class="radio-button-wrap">
                                                    @Html.RadioButtonFor(m => m.DateFilterMode, ChangeHistoryViewModel.DATE_FILTER_MODE_APPLIED, new {id = "datefiltermode-applied"})
                                                    <label class="edubase-button-radio" for="datefiltermode-applied">
                                                        Applied
                                                    </label>
                                                </span>
                                            </div>
                                            <div class="column-third">
                                                <span class="radio-button-wrap">
                                                    @Html.RadioButtonFor(m => m.DateFilterMode, ChangeHistoryViewModel.DATE_FILTER_MODE_APPROVED, new { id = "datefiltermode-approved" })
                                                    <label class="edubase-button-radio" for="datefiltermode-approved">
                                                        Approved
                                                    </label>
                                                </span>
                                            </div>
                                            <div class="column-third">
                                                <span class="radio-button-wrap">
                                                    @Html.RadioButtonFor(m => m.DateFilterMode, ChangeHistoryViewModel.DATE_FILTER_MODE_EFFECTIVE, new { id = "datefiltermode-effective" })
                                                    <label class="edubase-button-radio" for="datefiltermode-effective">
                                                        Effective
                                                    </label>
                                                </span>
                                            </div>
                                            <div class="column-half">
                                                @Html.EditorFor(x => x.DateFilterFrom, new { title = "From (optional)" })
                                            </div>
                                            <div class="column-half">
                                                @Html.EditorFor(x => x.DateFilterTo, new { title = "To (optional)" })
                                            </div>
                                            @Html.HiddenFor(x => x.TextSearchModel.AutoSuggestValue)
                                            <div class="form-group">
                                                <button type="submit" class="button mobile-full-width search-button" id="all-search-submit">Search</button>
                                            </div>

                                        </div>
                                    </fieldset>
                                }
                            </li>
                        </ul>
                    </fieldset>
                </div>
                <div id="groups" class="tab-content @((Model.SelectedTab != ChangeHistoryViewModel.Tab.Groups) ? "hidden-tab-content" : "")" aria-hidden="@(Model.SelectedTab != ChangeHistoryViewModel.Tab.Groups)">
                        
                </div>
            </div>
        </div>
    </div>
</div>

